{
  "id" : "768916ab-eb28-43e8-abb5-f33b04a421a4",
  "name" : "Demo Aptos Inventory to Commerce Cloud",
  "enabled" : false,
  "tasks" : [ {
    "id" : "0ab33d86-5251-415b-b966-585066d66238",
    "ordinal" : 1,
    "taskParameters" : [ {
      "id" : "c485a211-19ec-4e61-86f9-e0a54ae256bd",
      "ordinal" : 1,
      "value" : "ftpuser1",
      "desc" : "User to login to ftp",
      "name" : "user",
      "valueType" : 0,
      "secret" : false,
      "refId" : "4f75fa01-c582-49aa-8f20-1b48462a8b28"
    }, {
      "id" : "873b4898-74a9-4711-9ecc-17be3bc30bd9",
      "ordinal" : 2,
      "value" : "ORRKtLBMcxBEqbaWi/13jQ==",
      "desc" : "Password to login to ftp",
      "name" : "password",
      "valueType" : 0,
      "secret" : true,
      "refId" : "48fbf631-e014-45ee-a8eb-298ac7d1fa21"
    }, {
      "id" : "60ec08dc-dc1a-4f30-b459-1339d98ac91b",
      "ordinal" : 3,
      "value" : "ftps://demo.ignitiontransform.com/ignition/input/aptos-inventory.xml",
      "desc" : "Url to file",
      "name" : "url",
      "valueType" : 0,
      "secret" : false,
      "refId" : "45c250b3-72b5-4d81-a392-6ab7c6f5709d"
    }, {
      "id" : "c4e7c5d2-fbd7-4909-9378-d9cc8ee71570",
      "ordinal" : 4,
      "value" : "AptosInventoryFile",
      "desc" : "Key name of output file",
      "name" : "outputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "201b77ea-8e35-4c3c-9f45-dd8afc123e10"
    } ],
    "jobId" : "768916ab-eb28-43e8-abb5-f33b04a421a4",
    "name" : "Download File to Map Task",
    "key" : "Core::DownloadFileToMapTask",
    "comment" : "Pull down file from ftp server.",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.DownloadFileToMapTask",
    "enabled" : true,
    "desc" : "Task used to download a file from FTP,SFTP,FTPS,Local and S3.",
    "trigger" : true,
    "refId" : "84211b05-40ce-4939-874d-825b983c3bda",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "d6f483fd-8e6c-45fa-8747-7ba1b6aa6344",
    "ordinal" : 2,
    "taskParameters" : [ {
      "id" : "e886f1af-c47b-4a0d-b68d-5c4ed73bf204",
      "ordinal" : 1,
      "value" : "AptosInventoryFile",
      "desc" : "Key name of input file\n",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "33b71961-09fb-4f69-9df8-46721a14b8a4"
    }, {
      "id" : "b6ac592b-a188-47b5-9ac5-724a53c3e1d7",
      "ordinal" : 2,
      "value" : "AptosInventoryMap",
      "desc" : "Key name to hold return value in dictionary",
      "name" : "outputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "f1628808-0116-4d32-bff0-af0cb53d06b2"
    }, {
      "id" : "6333db97-678c-42bf-b772-6d70b13af679",
      "ordinal" : 4,
      "value" : "/ProductsInventory/ProductInventory",
      "desc" : "Node to Break the row on",
      "name" : "rowIndicator",
      "valueType" : 0,
      "secret" : false,
      "refId" : "be88cc2e-5ba9-4277-a484-1d8146b78565"
    } ],
    "jobId" : "768916ab-eb28-43e8-abb5-f33b04a421a4",
    "name" : "XML to Map Task",
    "key" : "Core::XmlToMapTask",
    "comment" : "Convert Aptos inventory file to a map",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.XmlToMapTask",
    "enabled" : true,
    "desc" : "Task used to read xml file into the dictionary",
    "trigger" : false,
    "refId" : "4ca3d6e5-23fc-4d6a-beb2-09f0c9a5c2f3",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "193e2e33-288f-447a-83d2-018d206a03e2",
    "ordinal" : 3,
    "taskParameters" : [ {
      "id" : "d196bd63-fa3c-4fdb-8a93-73e8d2848ec5",
      "ordinal" : 1,
      "value" : "// setup a formatter\nvar sdf = new java.text.SimpleDateFormat(\"yyyy-MM-dd'T'HH:mm:ss\");\n// Create an output map\nvar root = new java.util.HashMap();\n// List of Inventory.  (we only have 1 in this example)\nvar inventoryLists = new java.util.ArrayList();\n// Our inventory list and it's values.\nvar inventoryList = new java.util.HashMap();\ninventoryList.put(\"listId\", \"inventory\");\ninventoryList.put(\"defaultInStock\", \"true\");\ninventoryList.put(\"description\", \"Main Inventory\");\ninventoryList.put(\"useBundleOnly\", \"false\");\ninventoryList.put(\"onOrder\", \"false\");\nvar inventoryRecords = new java.util.ArrayList();\n\n// Read our inventory records 1 at a time\nvar inventoryIterator = new com.ignitioncommerce.transform.util.MapInFileIterator(dict.get('AptosInventoryMap'));\nwhile (inventoryIterator.hasNext()) {\n  var inventoryRecord = inventoryIterator.next();\n  var record = new java.util.HashMap();\n  record.put(\"productId\", inventoryRecord.ProductPartNo);\n  record.put(\"allocation\", inventoryRecord.ProductQuantity);\n  record.put(\"timestamp\", sdf.format(new java.util.Date()));\n  record.put(\"perpetual\", \"false\");\n  record.put(\"backOrderHandling\", \"backorder\");\n  record.put(\"ats\", inventoryRecord.ProductQuantity);\n  record.put(\"onOrder\", \"false\");\n  record.put(\"turnover\", \"false\");\n  inventoryRecords.add(record);  \n}\ninventoryList.put(\"Products\", inventoryRecords);\ninventoryLists.add(inventoryList);\nroot.put(\"InventoryLists\", inventoryLists);\n// Root is just a reference to the \"ROOT\" map in Freemarker\ndict.put('Root', root);\n",
      "desc" : "Script to execute",
      "name" : "script",
      "valueType" : 2,
      "secret" : false,
      "refId" : "61734d1c-1ff6-4a2b-a251-00f3bd76b9ed"
    } ],
    "jobId" : "768916ab-eb28-43e8-abb5-f33b04a421a4",
    "name" : "Script Task",
    "key" : "Core::ScriptTask",
    "comment" : "Prepare data by executing any client specific logic and setting up for template engine",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.ScriptTask",
    "enabled" : true,
    "desc" : "Task used to execute custom javascript",
    "trigger" : false,
    "refId" : "f5d44f40-cbd4-45fa-b45f-b062e546ad0f",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "83a20011-d6bb-4e91-9f16-9dc781419cba",
    "ordinal" : 4,
    "taskParameters" : [ {
      "id" : "9da57963-375c-45e2-a5d9-3dcb0f1596e3",
      "ordinal" : 1,
      "value" : "Root",
      "desc" : "Key name of input ",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "e2963db8-9c7d-4863-b1ec-7a1bf15dbd52"
    }, {
      "id" : "d1947bc4-3395-4e8b-b4a7-d673d5e964b9",
      "ordinal" : 2,
      "value" : "<#compress>\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<inventory xmlns=\"http://www.demandware.com/xml/impex/inventory/2007-05-31\">\n\t<#list InventoryLists as InventoryList>\n    <inventory-list>\n        <header list-id=\"${InventoryList.listId}\">\n            <default-instock>${InventoryList.defaultInStock}</default-instock>\n            <description>${InventoryList.description}</description>\n            <use-bundle-inventory-only>${InventoryList.useBundleOnly}</use-bundle-inventory-only>\n            <on-order>${InventoryList.onOrder}</on-order>\n        </header>\n        <records>\n        \t<#list InventoryList.Products as Product>\n            <record product-id=\"${Product.productId}\">\n                <allocation>${Product.allocation}</allocation>\n                <allocation-timestamp>${Product.timestamp}</allocation-timestamp>\n                <perpetual>${Product.perpetual}</perpetual>\n                <preorder-backorder-handling>${Product.backOrderHandling}</preorder-backorder-handling>\n                <ats>${Product.ats}</ats>\n                <on-order>${Product.onOrder}</on-order>\n                <turnover>${Product.turnover}</turnover>\n            </record>\n            </#list>\n        </records>\n    </inventory-list>\n    </#list>\n</inventory>\n</#compress>\n",
      "desc" : "Template to use",
      "name" : "template",
      "valueType" : 2,
      "secret" : false,
      "refId" : "ed2bc33b-2474-4c9f-a7bb-80183abe53cf"
    }, {
      "id" : "f922a96a-c16d-4258-89d6-f970b7f03523",
      "ordinal" : 3,
      "value" : "InventoryFile",
      "desc" : "Key name of output ",
      "name" : "outputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "be1f40ef-6389-4aa3-9124-4231b715107a"
    } ],
    "jobId" : "768916ab-eb28-43e8-abb5-f33b04a421a4",
    "name" : "Freemarker Execute Task",
    "key" : "Core::FreemarkerExecuteTask",
    "comment" : "Format to Commerce Cloud xml",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.FreemarkerExecuteTask",
    "enabled" : true,
    "desc" : "Task used to execute Freemarker template.",
    "trigger" : false,
    "refId" : "edb872f0-243b-46ea-9149-ca967fe766e7",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "5baff7c5-4d7a-45a5-bc30-ba3809c07279",
    "ordinal" : 5,
    "taskParameters" : [ {
      "id" : "6c2b2063-072d-4956-a3a5-4cec06190061",
      "ordinal" : 1,
      "value" : "CCInventoryFile",
      "desc" : "Left Hand Parameter (left of equal)",
      "name" : "leftParam",
      "valueType" : 0,
      "secret" : false,
      "refId" : "872220ae-b87f-4ee4-8f74-b818960e521f"
    }, {
      "id" : "51145a51-2426-41f0-812f-4a44c7c9acbb",
      "ordinal" : 2,
      "value" : "${ var sdf = new java.text.SimpleDateFormat(\"yyyyMMdd'_'HHmmss\"); \"aptos-inventory-\" + sdf.format(new java.util.Date()) + \".xml\"; }",
      "desc" : "Right Hand Parameter (right of equal)  Can contain ${} that contains javascript",
      "name" : "rightParam",
      "valueType" : 2,
      "secret" : false,
      "refId" : "983f881a-9f10-43cc-9850-e913d2ad530a"
    } ],
    "jobId" : "768916ab-eb28-43e8-abb5-f33b04a421a4",
    "name" : "Assign Task",
    "key" : "Core::AssignTask",
    "comment" : "Setup file name",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.AssignTask",
    "enabled" : true,
    "desc" : "Task used to Assign one key to another in the parameter dictionary",
    "trigger" : false,
    "refId" : "f749f807-bc45-4213-8db8-e66a8f263f44",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "2943d765-cfe1-47ed-a6e2-1c99dbcb6587",
    "ordinal" : 6,
    "taskParameters" : [ {
      "id" : "792faf8d-9053-4c93-b859-5d105f26f96e",
      "ordinal" : 1,
      "value" : "ftpuser",
      "desc" : "User to login to ftp",
      "name" : "user",
      "valueType" : 0,
      "secret" : false,
      "refId" : "a68a11c6-cef6-4408-85f5-4f0728e8e3c7"
    }, {
      "id" : "1c4ef638-00aa-42eb-a8b7-11a8a3998ffd",
      "ordinal" : 2,
      "value" : "ORRKtLBMcxBEqbaWi/13jQ==",
      "desc" : "Password to login to ftp",
      "name" : "password",
      "valueType" : 0,
      "secret" : true,
      "refId" : "a34fea04-c5b1-442c-975e-1655184f32f3"
    }, {
      "id" : "aba5cee9-6d64-4189-989f-442fa2456b16",
      "ordinal" : 3,
      "value" : "ftps://demo.ignitiontransform.com/ignition/output/${CCInventoryFile}",
      "desc" : "Url to file",
      "name" : "url",
      "valueType" : 0,
      "secret" : false,
      "refId" : "b102d706-66ce-4d8b-8944-ec8ba327b7b2"
    }, {
      "id" : "dbc5c807-4b22-4aad-ac6e-abc3dfe816ed",
      "ordinal" : 4,
      "value" : "InventoryFile",
      "desc" : "Key name of input file",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "06532b8a-daf2-457c-8c65-701e9cc0ec01"
    } ],
    "jobId" : "768916ab-eb28-43e8-abb5-f33b04a421a4",
    "name" : "Upload File from Map",
    "key" : "Core::UploadFileFromMapTask",
    "comment" : "Upload inventory file to output directory",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.UploadFileFromMapTask",
    "enabled" : true,
    "desc" : "Task used to upload a file to ftp, sftp, ftps, local or webdav from a map.",
    "trigger" : false,
    "refId" : "fb285dc7-59db-4382-b004-df6ee6147084",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  }, {
    "id" : "177d5d64-7046-4c9e-ab2e-55f14ac7b86f",
    "ordinal" : 7,
    "taskParameters" : [ {
      "id" : "784a7472-aae7-4749-aecb-87be3cf0f8a7",
      "ordinal" : 1,
      "value" : "ftpuser",
      "desc" : "User to login to ftp",
      "name" : "user",
      "valueType" : 0,
      "secret" : false,
      "refId" : "a68a11c6-cef6-4408-85f5-4f0728e8e3c7"
    }, {
      "id" : "e9c5d69d-3394-4cbc-994c-a614f57935e4",
      "ordinal" : 2,
      "value" : "ORRKtLBMcxBEqbaWi/13jQ==",
      "desc" : "Password to login to ftp",
      "name" : "password",
      "valueType" : 0,
      "secret" : true,
      "refId" : "a34fea04-c5b1-442c-975e-1655184f32f3"
    }, {
      "id" : "ac969bf1-df19-4300-9ca6-8519ea7d23c7",
      "ordinal" : 3,
      "value" : "ftps://demo.ignitiontransform.com/ignition/output/archive/${CCInventoryFile}",
      "desc" : "Url to file",
      "name" : "url",
      "valueType" : 0,
      "secret" : false,
      "refId" : "b102d706-66ce-4d8b-8944-ec8ba327b7b2"
    }, {
      "id" : "3fc8316a-e552-4c12-a507-7c33794db392",
      "ordinal" : 4,
      "value" : "InventoryFile",
      "desc" : "Key name of input file",
      "name" : "inputKey",
      "valueType" : 0,
      "secret" : false,
      "refId" : "06532b8a-daf2-457c-8c65-701e9cc0ec01"
    } ],
    "jobId" : "768916ab-eb28-43e8-abb5-f33b04a421a4",
    "name" : "Upload File from Map",
    "key" : "Core::UploadFileFromMapTask",
    "comment" : "Upload inventory file to an archive location",
    "clazz" : "com.ignitioncommerce.transform.tasks.core.UploadFileFromMapTask",
    "enabled" : true,
    "desc" : "Task used to upload a file to ftp, sftp, ftps, local or webdav from a map.",
    "trigger" : false,
    "refId" : "fb285dc7-59db-4382-b004-df6ee6147084",
    "clazzType" : "Java",
    "childTasks" : [ ],
    "hasSubTask" : false,
    "stopOnError" : true,
    "reportOnError" : true
  } ],
  "desc" : "Demo transformation of Aptos inventory API to Commerce Cloud Xml",
  "status" : "READY",
  "trigger" : true,
  "snsARN" : "arn:aws:sns:us-east-1:194810246581:Ignition_Job_e2a3ed17-d4af-4375-bbf4-50967c0b25c5"
}